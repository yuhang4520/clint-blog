---
title: 思索与启程：构建下一代AI驱动的Excel智能助手
date: '2025-06-28'
tags: ['Ai', 'next', 'vercel']
draft: false
summary: 项目总体介绍以及开发计划
---

**项目启动：用AI对话解放Excel文件处理**  
为解决复杂Excel表格的处理痛点（受伴侣工作场景启发），同时融合我学习AI技术（特别是NLP）与精进Next.js/Node.js的目标，我将开发一款**支持自然语言交互的Excel内容分析工具**。技术演进路径：

1. **前期**：通过云端AI快速验证原型
2. **后期**：迁移至开源本地AI模型
3. **终态**：基于 **Electron桌面框架 + Docker容器化** 提供安全无忧的离线部署方案

## 阶段1：云端原型验证（1-3天）

### 目标​​：实现核心流程，验证可行性。

#### 技术栈​​：

    - 前端：Next.js + Tailwind CSS。
    - 后端：Node.js + Express，使用libreoffice-core转换表格为SQLite。
    - AI：调用云端API（如OpenAI gpt-4-turbo），模拟文本转SQL。
    - 输出​​：网页应用，支持上传表格→输入指令→返回CSV结果。

#### 关键步骤：

    - 使用 [Chat sdk](https://chat-sdk.dev/)作为项目初始模板，接入 vercel 部署，本地跑通开发环境。([x] 已完成)
    - 移除模板中的 OAuth 登录、付费功能等无关代码。
    - 文本转sql技术选型以及验证.

## 阶段2：核心功能开发（2-3周）

### 目标​​：替换云端API为本地模型，实现离线运行。

#### 技术栈​​：

    - ​​表格解析层​​：
        - 使用 SheetJS 解析上传的 Excel/CSV → 输出 JSON 结构；
        - 动态创建内存数据库（DuckDB），将 JSON 数据写入表.
    - ​​自然语言转 SQL​​：（待思考）
    - 结果导出​​：添加前端按钮，将查询结果导出为 CSV/XLSX（用 SheetJS 反向生成）。

#### 关键步骤​​:

    - 选用Phi-3-mini或SQLCoder，通过transformers.js在浏览器运行（需启用WebGPU）。
    - 优化模型加载：动态加载量化版模型（如GGUF格式），减少内存占用。
    - 添加性能监控：记录SQL生成耗时，提供用户等待提示。
    ​​- 输出​​：纯网页端离线应用，支持基础指令

## 阶段3：桌面端封装（1-2周）

### 目标​​：Electron打包，提升系统资源访问能力。

#### ​关键步骤​​:

- 迁移Next.js到Electron，使用electron-forge打包。
- 调用本地文件系统API，实现处理结果自动保存。
- 添加硬件检测：启动时检查WebGPU支持，降级到CPU模式（llama.cpp）。
  ​- ​输出​​：桌面应用（Windows/macOS/Linux）。

## 阶段4：高级优化与扩展（持续迭代）

- ​​Docker支持​​：预置模型和SQLite的镜像，一键部署。
  ​​- 性能提升​​：
- SQL查询缓存：对相同指令复用结果。
- 多线程处理：用Node.js Worker线程执行AI推理。
  ​- ​功能扩展​​：
- 自定义插件：支持Python脚本处理复杂任务。
- 多表关联：允许用户上传多个文件并定义关联关系。

后续会更新项目进度，争取在7月底，达到一个阶段性目标
